Пайплайн машинного обучения для обучения и оценки моделей

Этот проект реализует пайплайн машинного обучения для загрузки данных, их предварительной обработки, обучения нескольких моделей и оценки их производительности. Пайплайн позволяет эффективно обрабатывать данные и сравнивать различные алгоритмы для выбора наилучшей модели.
Особенности

    Загрузка данных: Загрузка и объединение данных из нескольких CSV-файлов.
    Разделение данных: Разделение данных на обучающую и тестовую выборки.
    Оценка модели: Обучение моделей и оценка их производительности с использованием метрик, таких как R² и RMSE.
    Сравнение моделей: Сравнение нескольких алгоритмов для определения наилучшей модели на основе метрик производительности.
    Реализация пайплайна: Автоматизация всего процесса от загрузки данных до оценки моделей.

Функции
1. load_data

Загружает данные из указанных CSV-файлов и объединяет их в единый набор данных.

    Параметры:
        base_path: Путь к директории с файлами данных.
        data_files: Список имен файлов с данными.
        target_files: Список имен файлов с целевыми значениями.
        nrows: Количество строк для загрузки из каждого файла.

    Возвращает: Объединенные данные и целевые значения.

2. split_data

Разделяет данные на обучающую и тестовую выборки.

    Параметры:
        data: Данные признаков (DataFrame).
        target: Целевая переменная (DataFrame или Series).
        test_size: Доля тестовой выборки.
        random_state: Случайное состояние для воспроизводимости.

    Возвращает: X_train, X_test, y_train, y_test.

3. evaluate_model

Обучает модель и оценивает её производительность.

    Параметры:
        model: Модель машинного обучения.
        X_train, X_test, y_train, y_test: Данные для обучения и тестирования.

    Возвращает: Словарь с метриками, включая R², RMSE, процент улучшения, время обучения и время предсказания.

4. compare_models

Сравнивает несколько алгоритмов машинного обучения.

    Параметры:
        X_train, X_test, y_train, y_test: Данные для обучения и тестирования.

    Возвращает: Список результатов для каждого алгоритма.

5. pipeline

Выполняет полный пайплайн для обучения и оценки модели.

    Параметры:
        base_path: Путь к директории с файлами данных.
        data_files: Список имен файлов с данными.
        target_files: Список имен файлов с целевыми значениями.
        nrows: Количество строк для загрузки из каждого файла.

    Возвращает: Лучшая модель и её метрики производительности.

Использование

Для запуска пайплайна укажите пути к вашим данным и выполните скрипт. Пайплайн выведет лучшую модель и её метрики производительности.

if __name__ == "__main__":
    base_path = "/path/to/data"
    data_files = ["data1.csv", "data2.csv"]
    target_files = ["target1.csv", "target2.csv"]
    model, metrics = pipeline(base_path, data_files, target_files)
    print("Лучшая модель:", model)
    print("Метрики:", metrics)

Требования

    Python 3.x
    Pandas
    Scikit-learn
    XGBoost
    NumPy

Заключение

Этот пайплайн предоставляет упрощенный подход к обучению и оценке моделей машинного обучения, позволяя эффективно выбирать и оценивать производительность моделей.
